name: Refresh Demo Data

on:
  schedule:
    - cron: '0 */2 * * *'
  workflow_dispatch:
  push:
    branches: [ main ]

jobs:
  refresh:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: Create timestamp file
      run: |
        mkdir -p animal-humane/react-app/public/api/
        # Use the actual data date (when static data was captured)
        data_date="2026-01-01T15:00:00Z"
        data_timestamp=1767304800
        human_date="January 1, 2026 at 3:00 PM UTC"
        echo "{
          \"lastUpdated\": \"$data_date\",
          \"human_readable\": \"$human_date\",
          \"timestamp\": $data_timestamp
        }" > animal-humane/react-app/public/api/last-updated.json
        echo "Created timestamp file with actual data date:"
        cat animal-humane/react-app/public/api/last-updated.json
        
    - name: Commit and push
      uses: stefanzweifel/git-auto-commit-action@v5
      with:
        commit_message: 'Update demo timestamp'
        file_pattern: 'animal-humane/react-app/public/api/last-updated.json'